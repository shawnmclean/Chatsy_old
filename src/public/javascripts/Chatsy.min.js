(function(){this.ChatsyEngine=function(){function a(a,b){var c;this.user=b;if(!this.user)throw new ReferenceError("User cannot be null.");this.socket=io.connect(a),c=this,this.socket.on("joinedConfirm",function(a){return c.joinRoomConfirmed(a.roomId)}),this.socket.on("message",function(a){return console.log("test")})}a.prototype.rooms=[],a.prototype.unConfirmedRooms=[],a.prototype.user=null,a.prototype.socket=null,a.prototype.joinRoom=function(a){if(!a instanceof ChatsyRoom)throw new Exception('parameter must be of type "ChatsyRoom"');this.socket.emit("joinRoom",{room:a.data,user:this.user});if(!(this.unConfirmedRooms.indexOf(a)>=0))return this.unConfirmedRooms.push(a)},a.prototype.joinRoomConfirmed=function(a){var b,c;b=this,c=this.unConfirmedRooms.filter(function(b,c,d){return b.data.roomId===a})[0];if(c){this.rooms.push(c),c.joinedConfirm();return c.onSendMessage=function(a,c){return b.sendMessage(a,c)}}},a.prototype.sendMessage=function(a,b){return this.socket.emit("message",{roomId:b,message:a})};return a}(),this.ChatsyRoom=function(){function a(a,b){this.data=a;if(!this.data)throw new ReferenceError("All arguments should not be null.");b&&(this.messageRecieved=b.messageRecieved,this.userJoined=b.userJoined,this.userLeave=b.userLeave,this.roomJoined=b.roomJoined)}a.prototype.data=null,a.prototype.users=null,a.prototype.messageRecieved=null,a.prototype.userJoined=null,a.prototype.userLeave=null,a.prototype.roomJoined=null,a.prototype.onSendMessage=null,a.prototype.joinedConfirm=function(){if(this.roomJoined)return this.roomJoined()},a.prototype.sendMessage=function(a){if(this.onSendMessage)return this.onSendMessage(a,this.data.roomId)};return a}(),function(a){var b;return b={Away:0,Back:1,Visible:2,Hidden:3}}(typeof exports=="undefined"?this.Chatsy={}:exports)}).call(this)